var path=window.location.pathname.slice(1),settings={api_url:"/api"},Webigma=React.createClass({displayName:"Webigma",getInitialState:function(){return{state:"init",message:"Мы начинаем КВН",overlay:!1}},componentDidMount:function(){this.props.path&&this.get(path)},get:function(e){this.setState({state:"recieving"}),$.ajax({url:this.props.settings.api_url+"/"+e,method:"get",success:function(e){this.setState({state:"recieve",message:e.content,overlay:!0})}.bind(this),error:function(e,t){this.setState({state:"recieve",message:"Something went wrong: "+t.toString(),overlay:!0})}.bind(this)})},post:function(e){this.setState({state:"posting"}),$.ajax({url:this.props.settings.api_url,data:JSON.stringify(e),dataType:"json",method:"post",success:function(e){this.setState({state:"recieve"}),this.refs.secret.getDOMNode().value="",this.setState({message:e.link,overlay:!0})}.bind(this),error:function(e,t){this.setState({state:"recieve",message:"Something went wrong: "+t.toString(),overlay:!0})}.bind(this)})},handleSubmit:function(){return this.post({content:this.refs.secret.getDOMNode().value,expire:this.refs.expire.getDOMNode().value,num:this.refs.number.getDOMNode().value,callback:this.refs.callback.getDOMNode().value}),!1},handleOverlayClose:function(){this.setState({message:"",overlay:!1})},render:function(){var e=this.state.state,t=["b-webigma"];switch(button_is_disabled=!1,t.push("b-webigma_state_"+e),t=t.join(" "),e){case"posting":case"recieving":button_is_disabled=!0;break;case"recieve":}return React.DOM.div({className:t},React.DOM.h1({className:"b-webigma__heading"},"All hail the Huigma"),React.DOM.form({method:"post",action:this.props.settings.api_url},React.DOM.textarea({className:"b-webigma__text",ref:"secret",spellCheck:"false"}),React.DOM.input({className:"b-webigma__text-input",type:"text",ref:"expire",placeholder:"[expire, sec] 1800"}),React.DOM.input({className:"b-webigma__text-input",type:"text",ref:"number",placeholder:"[number, num] 1"}),React.DOM.input({className:"b-webigma__text-input",type:"text",ref:"callback",placeholder:"[callback, url]"}),React.DOM.button({onClick:this.handleSubmit,className:"b-webigma__submit",disabled:button_is_disabled},React.DOM.i({className:"fa fa-lock"}))),React.DOM.div({className:"b-webigma__message-wrapper"},React.DOM.div({className:"b-webigma__message"},this.state.message)),React.DOM.div({className:"b-webigma__copyright"},"© ",React.DOM.a({href:"https://github.com/miller-hacks"},"miller-hacks"),", 2014"),Overlay({content:this.state.message,is_open:this.state.overlay,onOverlayClose:this.handleOverlayClose}))}}),Overlay=React.createClass({displayName:"Overlay",getInitialState:function(){return{}},getDefaultProps:function(){return{content:React.DOM.p(null,"Bee-bee, bee-bee, yeah")}},componentDidMount:function(){},render:function(){var e=["b-overlay"],t="b-overlay_scale";return e.push(t),this.props.is_open&&e.push(t+"_open"),e=e.join(" "),React.DOM.div({className:e},React.DOM.button({type:"button",className:"b-overlay__close",onClick:this.props.onOverlayClose},React.DOM.i({className:"fa fa-ban"})),React.DOM.div({className:"b-overlay__content"},this.props.content))}});React.renderComponent(Webigma({settings:settings,path:path}),document.getElementById("app"));