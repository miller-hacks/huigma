var path=window.location.pathname.slice(1),settings={api_url:"/api"},Webigma=React.createClass({displayName:"Webigma",getInitialState:function(){return{state:"init",message:"Мы начинаем КВН"}},componentDidMount:function(){this.props.path&&this.get(path)},get:function(e){this.setState({state:"recieving"}),$.ajax({url:this.props.settings.api_url+"/"+e,method:"get",success:function(e){this.setState({state:"recieve"}),this.refs.secret.getDOMNode().value=e.content,this.refs.number.getDOMNode().value=e.num}.bind(this),error:function(){this.setState({state:"recieve"})}.bind(this)})},post:function(e){this.setState({state:"posting"}),$.ajax({url:this.props.settings.api_url,data:JSON.stringify(e),dataType:"json",method:"post",success:function(e){this.setState({state:"recieve"}),this.refs.secret.getDOMNode().value=e.link}.bind(this),error:function(){this.setState({state:"recieve"})}.bind(this)})},handleSubmit:function(){return this.post({content:this.refs.secret.getDOMNode().value,expire:this.refs.expire.getDOMNode().value,num:this.refs.number.getDOMNode().value,callback:this.refs.callback.getDOMNode().value}),!1},render:function(){var e=this.state.state,t="b-webigma";switch(button_is_disabled=!1,t=t+" b-webigma_state_"+e,e){case"posting":case"recieving":button_is_disabled=!0;break;case"recieve":}return React.DOM.div({className:t},React.DOM.h1({className:"b-webigma__heading"},"All hail the Huigma"),React.DOM.form({method:"post",action:this.props.settings.api_url},React.DOM.textarea({className:"b-webigma__text",ref:"secret",spellCheck:"false"}),React.DOM.input({className:"b-webigma__text-input",type:"text",ref:"expire",placeholder:"[expire, sec] 1800"}),React.DOM.input({className:"b-webigma__text-input",type:"text",ref:"number",placeholder:"[number, num] 1"}),React.DOM.input({className:"b-webigma__text-input",type:"text",ref:"callback",placeholder:"[callback, url]"}),React.DOM.button({onClick:this.handleSubmit,className:"b-webigma__submit",disabled:button_is_disabled},React.DOM.i({className:"fa fa-lock"}))),React.DOM.div({className:"b-webigma__message-wrapper"},React.DOM.div({className:"b-webigma__message"},this.state.message)),React.DOM.div({className:"b-webigma__copyright"},"© ",React.DOM.a({href:"https://github.com/miller-hacks"},"miller-hacks"),", 2014"))}});React.renderComponent(Webigma({settings:settings,path:path}),document.getElementById("app"));